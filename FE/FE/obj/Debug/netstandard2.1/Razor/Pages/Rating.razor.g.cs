#pragma checksum "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "2b2af42b8b912153575be994831d4028da6a92b9"
// <auto-generated/>
#pragma warning disable 1591
namespace FE.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using FE;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using FE.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\_Imports.razor"
using BlazorStrap;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
using System.Net.Http.Headers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
using Blazored.LocalStorage;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
using Models;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/rating")]
    public partial class Rating : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenElement(0, "html");
            __builder.AddMarkupContent(1, "\r\n");
            __builder.AddMarkupContent(2, "<head>\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../css/rating1.css\">\r\n    <h1>Rating</h1>\r\n</head>\r\n");
            __builder.OpenElement(3, "body");
            __builder.AddMarkupContent(4, "\r\n    ");
            __builder.OpenElement(5, "section");
            __builder.AddAttribute(6, "class", "rating-block");
            __builder.AddMarkupContent(7, "\r\n        ");
            __builder.OpenElement(8, "div");
            __builder.AddAttribute(9, "class", "container");
            __builder.AddMarkupContent(10, "\r\n            ");
            __builder.AddMarkupContent(11, "<div class=\"row\">\r\n                <div class=\"col-md-4 rating-sec\">\r\n                    <h2 class=\"text-center\">Rate one of the movies on our site.</h2>\r\n                    <form class=\"rating-form\">\r\n                        <div class=\"form-group\">\r\n                            <label for=\"exampleInputMovieName\" class=\"text-uppercase\">Enter movie Name</label>\r\n                            <input type=\"text\" id=\"name\" class=\"form-control\" placeholder=\"Movie name\">\r\n                        </div>\r\n\r\n                        <div class=\"rate\">\r\n                            <input type=\"radio\" id=\"star5\" name=\"rate\" value=\"5\">\r\n                            <label for=\"star5\" title=\"text\">10 stars</label>\r\n                            <input type=\"radio\" id=\"star4\" name=\"rate\" value=\"4\">\r\n                            <label for=\"star4\" title=\"text\">9 stars</label>\r\n                            <input type=\"radio\" id=\"star3\" name=\"rate\" value=\"3\">\r\n                            <label for=\"star3\" title=\"text\">8 stars</label>\r\n                            <input type=\"radio\" id=\"star2\" name=\"rate\" value=\"2\">\r\n                            <label for=\"star2\" title=\"text\">7 stars</label>\r\n                            <input type=\"radio\" id=\"star1\" name=\"rate\" value=\"1\">\r\n                            <label for=\"star1\" title=\"text\">6 star</label>\r\n                            <input type=\"radio\" id=\"star5\" name=\"rate\" value=\"5\">\r\n                            <label for=\"star5\" title=\"text\">5 stars</label>\r\n                            <input type=\"radio\" id=\"star4\" name=\"rate\" value=\"4\">\r\n                            <label for=\"star4\" title=\"text\">4 stars</label>\r\n                            <input type=\"radio\" id=\"star3\" name=\"rate\" value=\"3\">\r\n                            <label for=\"star3\" title=\"text\">3 stars</label>\r\n                            <input type=\"radio\" id=\"star2\" name=\"rate\" value=\"2\">\r\n                            <label for=\"star2\" title=\"text\">2 stars</label>\r\n                            <input type=\"radio\" id=\"star1\" name=\"rate\" value=\"1\">\r\n                            <label for=\"star1\" title=\"text\">1 star</label>\r\n                        </div>\r\n\r\n                        <div class=\"form-check\">\r\n\r\n                            <input @*@onclick=\"@AddRating\" *@ type=\"submit\" class=\"btn btn-rating float-right\" value=\"Send rating\" @*disabled=@isSubmitting*@>\r\n\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n                <div class=\"col-md-8 banner-sec\">\r\n                    <img src=\"https://i.ibb.co/x2GnTWj/rating.jpg\" alt=\"First slide\">\r\n\r\n\r\n\r\n                </div>\r\n            </div>\r\n");
#nullable restore
#line 63 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
             if (_ratings.Any())
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(12, "                ");
            __builder.OpenElement(13, "div");
            __builder.AddAttribute(14, "class", "rating-list");
            __builder.AddMarkupContent(15, "\r\n");
#nullable restore
#line 66 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
                     foreach (var rating in _ratings)
                    {

#line default
#line hidden
#nullable disable
            __builder.AddContent(16, "                        ");
            __builder.OpenElement(17, "div");
            __builder.AddAttribute(18, "class", "rating-el");
            __builder.AddMarkupContent(19, "\r\n                            ");
            __builder.OpenElement(20, "div");
            __builder.AddAttribute(21, "class", "card-body");
            __builder.AddMarkupContent(22, "\r\n                                ");
            __builder.OpenElement(23, "h5");
            __builder.AddAttribute(24, "class", "movie-title");
            __builder.AddContent(25, 
#nullable restore
#line 70 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
                                                         rating.MovieTitle

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(26, "\r\n                                ");
            __builder.OpenElement(27, "p");
            __builder.AddAttribute(28, "class", "rating-info");
            __builder.AddMarkupContent(29, "\r\n                                    ");
            __builder.AddMarkupContent(30, "<strong>Your Rating: </strong> ");
            __builder.AddContent(31, 
#nullable restore
#line 72 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
                                                                    rating.Rated

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(32, "\r\n                                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(33, "\r\n                                ");
            __builder.AddMarkupContent(34, "<button>Go to movie page</button>\r\n                            ");
            __builder.CloseElement();
            __builder.AddMarkupContent(35, "\r\n                        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(36, "\r\n");
#nullable restore
#line 77 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
                    }

#line default
#line hidden
#nullable disable
            __builder.AddContent(37, "                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(38, "\r\n");
#nullable restore
#line 79 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
            }

            else if (isLoaded == true)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(39, "                ");
            __builder.AddMarkupContent(40, "<p>No Ratings Found</p>\r\n");
#nullable restore
#line 84 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.AddContent(41, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(43, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(44, "\r\n");
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 90 "C:\Users\Teodora\Desktop\PlayNet\FE\FE\Pages\Rating.razor"
       

    private List<Movie> movies = new List<Movie>();

    private async Task GetMovies() => movies = await Http.GetFromJsonAsync<List<Movie>>("https://localhost:44385/movies");

    List<RatingEntry> _ratings = new List<RatingEntry>();
    private bool isLoaded;
    private Movie chosenMovie;
    private int chosenRating;


    protected override async Task OnInitializedAsync()
    {
        await GetMovies();
        await GetUserRatings();
    }
    private async Task InsertRating()
    {
        string userId = await localStore.GetItemAsync<string>("userId");
        string token = await localStore.GetItemAsync<string>("token");
        Http.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);
        RatingEntry ratingEntry = new RatingEntry
        {
            UserId = userId,
            MovieId = chosenMovie.Id,
            Rated = chosenRating,
            MovieTitle = chosenMovie.Title,
            Votes = chosenMovie.Votes
        };
        var response = await Http.PostAsJsonAsync("https://localhost:44385/users/login", ratingEntry);
    }
    private async Task GetUserRatings()
    {
        isLoaded = false;
        string userId = await localStore.GetItemAsync<string>("userId");
        string token = await localStore.GetItemAsync<string>("token");

        Http.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);
        _ratings = await Http.GetFromJsonAsync<List<RatingEntry>>("https://localhost:44385/rating/user/" + userId);
        isLoaded = true;
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ILocalStorageService localStore { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
    }
}
#pragma warning restore 1591
